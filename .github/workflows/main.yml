name: Full-Stack Component Pipeline
on: [push]

jobs:
  # This job now just "orders" a build from your central brain
  Backend-Build:
    uses: Bhuvaneshwaran-17/central-devops-tooling/.github/workflows/java-build-template.yml@main
    with:
      project_name: "E-Commerce-Backend"
      java-version: "17"           # Optional: defaults to 17
      pom_path: "backend/pom.xml"
    secrets:
      WEBHOOK_URL: ${{ secrets.TESTING_WEBHOOK }}

  # You still need to create the Node template for this to work
  Frontend-Build:
    uses: Bhuvaneshwaran-17/central-devops-tooling/.github/workflows/node-build-template.yml@main
    with:
      project_name: "E-Commerce-Frontend"
      working_directory: "frontend"
    secrets:
      WEBHOOK_URL: ${{ secrets.TESTING_WEBHOOK }}

  Success-Notification:
    needs: [Backend-Build, Frontend-Build]
    if: success()
    uses: Bhuvaneshwaran-17/central-devops-tooling/.github/workflows/teams-notifier.yml@main
    with:
      project_name: "E-Commerce"
      component_name: "FULL-STACK"
      status: "SUCCESS"
    secrets:
      WEBHOOK_URL: ${{ secrets.TESTING_WEBHOOK }}